import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

// Products that should exist (from your list)
const requiredProducts = [
  // GAMME W ‚Äì Anti-Taches
  'Mousse Nettoyante PURI-ALBUCIN I 150ml',
  'Cr√©me de Nuit ALBUCIN-INTENSIVE 30ml',
  'Cr√®me de Jour SPF 50+ ALBUCIN-TRIPLE ACTION 30ml',
  'Contour des Yeux OPTI-ALBUCIN 15ml',
  'Coup d\'√©clat Imm√©diat Hydratation ALBUCIN -MELA 30ml',
  'R√©duit les Hyperpigmentations (Post Inflammatoires) ALBUCIN-PP 3x4ml',
  'Coup d\'√©clat ,Hydratation et Pr√©vention des Rides ALBUCIN-C 5%de vitamine C 30ml',
  'Eau Tonifiante PURI-ALBUCIN II 150ml',
  
  // GAMME V ‚Äì Vitiligo
  'Cr√®me protectrice spf 50+ pour la peau avec le probl√®me du vitiligo-pour le visage et le corps Viti-melo day 75 ml',
  'Cr√®me repigmentante avec une zone r√©duite de taches de blanchiment pour le visage et le corps la nuit Viti-melo night 40 ml',
  
  // GAMME T ‚Äì Acn√©ique
  'Gel lavant antibact√©rien t pour le visage Puri-sebogel 190 ml',
  'Cr√®me avec retinol pour l\'acn√© adulte la nuit PUR-Retinol 0,3 40 ml',
  'Spf 30 cr√®me hydratante et apaisante pour le visage pendant et apr√®s les traitements anti acn√© Sebo-moistatic 50 ml',
  'Mousse Nettoyante PURI-SEBOSTATIQUE 150ml',
  'Stop Boutons Gel Spot Gel 10ml',
  'Cr√®me Protectrice SPF 50+ Medi-Acn√© Protect 50ml',
  
  // GAMME S ‚Äì Protection solaire
  'Huile de protection s√®che spf 50+ Sun protect 200 ml',
  'Baume protecteur hydrolipide spf 50+ Sun body protect 150 ml',
  'Cr√®me protectrice spf 50+ pour l\'acn√© Medi acne protect 50 ml',
  'Cr√®me protectrice s√©curis√©e spf 50+ pour les enfants Filtres 100% min√©raux 50 ml',
  'Cr√®me solaire protectrice spf 50+ visage et corps Pour b√©b√©s et enfants 125 ml',
  'Spectrum Protect spf50+ SUN PROTECTION CREAM 50ml',
  'Fluide protecteur-correctif haute protection spf 50+ Correction solaire 02 Sable 30 ml',
  'Fluide protecteur-correctif haute protection spf 50+ Correction solaire 01 Sable 30 ml',
  'ALBUCIN ‚Äì Cr√®me de Jour SPF 50+ ALBUCIN-TRIPLE ACTION 30ml',
  
  // GAMME P ‚Äì Psoriasis
  'Gel lavant corps et peau r√©gulant le processus de peeling Puri-ichtilium 250 ml',
  'Corps apaisant et fatning Ichtilium cr√®me corps 175 ml',
  
  // GAMME H ‚Äì Cheveux et Cuir chevelu
  'Shampoing Normalisant Cheveux Gras H-SEBOPURIN 250ml',
  'Shampoing Cheveux Fins et Affaiblis H-KERATINEUM 250ml',
  'Shampoing Anti-Pelliculaire Pellicules Grasses H-PURIN OILY 250ml',
  'Shampoing Anti-Pelliculaire Pellicules Seches H-PURIN OILY 250ml',
  'Shampoing Cuir chevelu Sensible H-SENSITONIN 250ml',
  'Shampoing Anti-Chute Anti-Cheveux Gris H-STIMUTONE 250ml',
  'Sparay Anti-Chute H-STIMUFORTEN 125ml',
  'Apr√®s Shampoing Anti-Chute H-STIMULINUM 250ml',
  'Shampoing Anti-Chute H-STIMUPURIN 250ml',
  'Shampoing Anti-Chute Anti-Pelliculaire H-STIMUCLARIS 250ml',
  'Shampoing Cheveux Sec H-NUTRIMELIN 250ml',
  
  // GAMME E ‚Äì Peau S√®che et Atopique
  'Cr√®me min√©rale dermo-protectrice EMOTOPIQUE SPF 50+ CR√âME EMOTOPIC 75ml',
  
  // GAMME A ‚Äì Peau Allergique et Sensible
  'Eau Micellaire PREBIO-SENSITIQUE 200ml',
  'Mousse Nettoyante PURI-SENSILIUM 150ml',
  'Contour des Yeux OPTI-SENSILIUM 15m',
  'Cr√®me L√©g√®re SPF20 VITA-SENSILIUM 50ml',
  'Cr√©me Hydratante Riche en Eau HYALURO-SENSILIUM 40ml',
  'Cr√®me Protectrice Sp√©cifique MEDI PROTECTRICE 75ml',
  'Cr√®me R√©paratrice et R√©g√©n√©ratrice CORNEO-SENSILIUM 75ml',
  
  // GAMME F ‚Äì Fluid Fondation
  'Fluide protecteur et correcteur la plus haute protection spf 50+ ‚Äì Correction solaire 02 Ivoire 30 ml',
  'Fluide protecteur-correctif haute protection spf 50+ ‚Äì Correction solaire 01 Sable 30 ml'
]

async function verifyPharmacerisProducts() {
  console.log('üîç Verifying Pharmaceris products against required list...')
  
  // Find Pharmaceris brand
  const pharmacerisBrand = await prisma.brand.findFirst({
    where: {
      name: {
        contains: 'Pharmaceris',
        mode: 'insensitive'
      }
    }
  })
  
  if (!pharmacerisBrand) {
    console.log('‚ùå Pharmaceris brand not found in database')
    return
  }
  
  // Get all current Pharmaceris products
  const currentProducts = await prisma.product.findMany({
    where: {
      brand_id: pharmacerisBrand.id
    },
    include: {
      category: true
    }
  })
  
  console.log(`üì¶ Current Pharmaceris products: ${currentProducts.length}`)
  console.log(`üìã Required products: ${requiredProducts.length}`)
  
  let foundCount = 0
  let missingCount = 0
  let extraCount = 0
  
  const foundProducts: string[] = []
  const missingProducts: string[] = []
  const extraProducts: string[] = []
  
  // Check which required products are found
  for (const requiredProduct of requiredProducts) {
    const found = currentProducts.find(p => 
      p.name.toLowerCase().includes(requiredProduct.toLowerCase()) ||
      requiredProduct.toLowerCase().includes(p.name.toLowerCase()) ||
      // Handle special cases with slight name differences
      (requiredProduct.includes('ALBUCIN-TRIPLE ACTION') && p.name.includes('ALBUCIN ‚Äì Cr√®me de Jour SPF 50+')) ||
      (requiredProduct.includes('OPTI-ALBUCIN') && p.name.includes('Contour des Yeux')) ||
      (requiredProduct.includes('ALBUCIN -MELA') && p.name.includes('Coup d\'√©clat Imm√©diat Hydratation')) ||
      (requiredProduct.includes('ALBUCIN-PP') && p.name.includes('R√©duit les Hyperpigmentations')) ||
      (requiredProduct.includes('ALBUCIN-C') && p.name.includes('Coup d\'√©clat ,Hydratation et Pr√©vention des Rides')) ||
      (requiredProduct.includes('PURI-ALBUCIN II') && p.name.includes('Eau Tonifiante')) ||
      (requiredProduct.includes('Viti-melo day') && p.name.includes('Cr√®me protectrice spf 50+')) ||
      (requiredProduct.includes('Viti-melo night') && p.name.includes('Cr√®me repigmentante')) ||
      (requiredProduct.includes('Puri-sebogel') && p.name.includes('Gel lavant antibact√©rien')) ||
      (requiredProduct.includes('PUR-Retinol') && p.name.includes('Cr√®me avec retinol')) ||
      (requiredProduct.includes('Sebo-moistatic') && p.name.includes('Spf 30 cr√®me hydratante')) ||
      (requiredProduct.includes('PURI-SEBOSTATIQUE') && p.name.includes('Mousse Nettoyante')) ||
      (requiredProduct.includes('Stop Boutons Gel') && p.name.includes('Stop Boutons Gel')) ||
      (requiredProduct.includes('Medi-Acn√© Protect') && p.name.includes('Cr√®me Protectrice SPF 50+')) ||
      (requiredProduct.includes('Sun protect') && p.name.includes('Huile de protection s√®che')) ||
      (requiredProduct.includes('Sun body protect') && p.name.includes('Baume protecteur hydrolipide')) ||
      (requiredProduct.includes('Medi acne protect') && p.name.includes('Cr√®me protectrice spf 50+ pour l\'acn√©')) ||
      (requiredProduct.includes('Filtres 100% min√©raux') && p.name.includes('Cr√®me protectrice s√©curis√©e')) ||
      (requiredProduct.includes('Pour b√©b√©s et enfants') && p.name.includes('Cr√®me solaire protectrice')) ||
      (requiredProduct.includes('SUN PROTECTION CREAM') && p.name.includes('Spectrum Protect')) ||
      (requiredProduct.includes('Correction solaire 02 Sable') && p.name.includes('Fluide protecteur-correctif haute protection')) ||
      (requiredProduct.includes('Correction solaire 01 Sable') && p.name.includes('Fluide protecteur-correctif haute protection')) ||
      (requiredProduct.includes('Puri-ichtilium') && p.name.includes('Gel lavant corps et peau')) ||
      (requiredProduct.includes('Ichtilium cr√®me corps') && p.name.includes('Corps apaisant et fatning')) ||
      (requiredProduct.includes('H-SEBOPURIN') && p.name.includes('Shampoing Normalisant Cheveux Gras')) ||
      (requiredProduct.includes('H-KERATINEUM') && p.name.includes('Shampoing Cheveux Fins et Affaiblis')) ||
      (requiredProduct.includes('H-PURIN OILY') && p.name.includes('Shampoing Anti-Pelliculaire Pellicules Grasses')) ||
      (requiredProduct.includes('H-PURIN OILY') && p.name.includes('Shampoing Anti-Pelliculaire Pellicules Seches')) ||
      (requiredProduct.includes('H-SENSITONIN') && p.name.includes('Shampoing Cuir chevelu Sensible')) ||
      (requiredProduct.includes('H-STIMUTONE') && p.name.includes('Shampoing Anti-Chute Anti-Cheveux Gris')) ||
      (requiredProduct.includes('H-STIMUFORTEN') && p.name.includes('Sparay Anti-Chute')) ||
      (requiredProduct.includes('H-STIMULINUM') && p.name.includes('Apr√®s Shampoing Anti-Chute')) ||
      (requiredProduct.includes('H-STIMUPURIN') && p.name.includes('Shampoing Anti-Chute')) ||
      (requiredProduct.includes('H-STIMUCLARIS') && p.name.includes('Shampoing Anti-Chute Anti-Pelliculaire')) ||
      (requiredProduct.includes('H-NUTRIMELIN') && p.name.includes('Shampoing Cheveux Sec')) ||
      (requiredProduct.includes('EMOTOPIC') && p.name.includes('Cr√®me min√©rale dermo-protectrice')) ||
      (requiredProduct.includes('PREBIO-SENSITIQUE') && p.name.includes('Eau Micellaire')) ||
      (requiredProduct.includes('PURI-SENSILIUM') && p.name.includes('Mousse Nettoyante')) ||
      (requiredProduct.includes('OPTI-SENSILIUM') && p.name.includes('Contour des Yeux')) ||
      (requiredProduct.includes('VITA-SENSILIUM') && p.name.includes('Cr√®me L√©g√®re SPF20')) ||
      (requiredProduct.includes('HYALURO-SENSILIUM') && p.name.includes('Cr√©me Hydratante Riche en Eau')) ||
      (requiredProduct.includes('MEDI PROTECTRICE') && p.name.includes('Cr√®me Protectrice Sp√©cifique')) ||
      (requiredProduct.includes('CORNEO-SENSILIUM') && p.name.includes('Cr√®me R√©paratrice et R√©g√©n√©ratrice')) ||
      (requiredProduct.includes('Correction solaire 02 Ivoire') && p.name.includes('Fluide protecteur et correcteur la plus haute protection')) ||
      (requiredProduct.includes('Correction solaire 01 Sable') && p.name.includes('Fluide protecteur-correctif haute protection'))
    )
    
    if (found) {
      foundProducts.push(requiredProduct)
      foundCount++
    } else {
      missingProducts.push(requiredProduct)
      missingCount++
    }
  }
  
  // Check for extra products not in the required list
  for (const product of currentProducts) {
    const isInRequiredList = requiredProducts.some(required => 
      product.name.toLowerCase().includes(required.toLowerCase()) ||
      required.toLowerCase().includes(product.name.toLowerCase()) ||
      // Handle special cases
      (required.includes('ALBUCIN-TRIPLE ACTION') && product.name.includes('ALBUCIN ‚Äì Cr√®me de Jour SPF 50+')) ||
      (required.includes('OPTI-ALBUCIN') && product.name.includes('Contour des Yeux')) ||
      (required.includes('ALBUCIN -MELA') && product.name.includes('Coup d\'√©clat Imm√©diat Hydratation')) ||
      (required.includes('ALBUCIN-PP') && product.name.includes('R√©duit les Hyperpigmentations')) ||
      (required.includes('ALBUCIN-C') && product.name.includes('Coup d\'√©clat ,Hydratation et Pr√©vention des Rides')) ||
      (required.includes('PURI-ALBUCIN II') && product.name.includes('Eau Tonifiante')) ||
      (required.includes('Viti-melo day') && product.name.includes('Cr√®me protectrice spf 50+')) ||
      (required.includes('Viti-melo night') && product.name.includes('Cr√®me repigmentante')) ||
      (required.includes('Puri-sebogel') && product.name.includes('Gel lavant antibact√©rien')) ||
      (required.includes('PUR-Retinol') && product.name.includes('Cr√®me avec retinol')) ||
      (required.includes('Sebo-moistatic') && product.name.includes('Spf 30 cr√®me hydratante')) ||
      (required.includes('PURI-SEBOSTATIQUE') && product.name.includes('Mousse Nettoyante')) ||
      (required.includes('Stop Boutons Gel') && product.name.includes('Stop Boutons Gel')) ||
      (required.includes('Medi-Acn√© Protect') && product.name.includes('Cr√®me Protectrice SPF 50+')) ||
      (required.includes('Sun protect') && product.name.includes('Huile de protection s√®che')) ||
      (required.includes('Sun body protect') && product.name.includes('Baume protecteur hydrolipide')) ||
      (required.includes('Medi acne protect') && product.name.includes('Cr√®me protectrice spf 50+ pour l\'acn√©')) ||
      (required.includes('Filtres 100% min√©raux') && product.name.includes('Cr√®me protectrice s√©curis√©e')) ||
      (required.includes('Pour b√©b√©s et enfants') && product.name.includes('Cr√®me solaire protectrice')) ||
      (required.includes('SUN PROTECTION CREAM') && product.name.includes('Spectrum Protect')) ||
      (required.includes('Correction solaire 02 Sable') && product.name.includes('Fluide protecteur-correctif haute protection')) ||
      (required.includes('Correction solaire 01 Sable') && product.name.includes('Fluide protecteur-correctif haute protection')) ||
      (required.includes('Puri-ichtilium') && product.name.includes('Gel lavant corps et peau')) ||
      (required.includes('Ichtilium cr√®me corps') && product.name.includes('Corps apaisant et fatning')) ||
      (required.includes('H-SEBOPURIN') && product.name.includes('Shampoing Normalisant Cheveux Gras')) ||
      (required.includes('H-KERATINEUM') && product.name.includes('Shampoing Cheveux Fins et Affaiblis')) ||
      (required.includes('H-PURIN OILY') && product.name.includes('Shampoing Anti-Pelliculaire Pellicules Grasses')) ||
      (required.includes('H-PURIN OILY') && product.name.includes('Shampoing Anti-Pelliculaire Pellicules Seches')) ||
      (required.includes('H-SENSITONIN') && product.name.includes('Shampoing Cuir chevelu Sensible')) ||
      (required.includes('H-STIMUTONE') && product.name.includes('Shampoing Anti-Chute Anti-Cheveux Gris')) ||
      (required.includes('H-STIMUFORTEN') && product.name.includes('Sparay Anti-Chute')) ||
      (required.includes('H-STIMULINUM') && product.name.includes('Apr√®s Shampoing Anti-Chute')) ||
      (required.includes('H-STIMUPURIN') && product.name.includes('Shampoing Anti-Chute')) ||
      (required.includes('H-STIMUCLARIS') && product.name.includes('Shampoing Anti-Chute Anti-Pelliculaire')) ||
      (required.includes('H-NUTRIMELIN') && product.name.includes('Shampoing Cheveux Sec')) ||
      (required.includes('EMOTOPIC') && product.name.includes('Cr√®me min√©rale dermo-protectrice')) ||
      (required.includes('PREBIO-SENSITIQUE') && product.name.includes('Eau Micellaire')) ||
      (required.includes('PURI-SENSILIUM') && product.name.includes('Mousse Nettoyante')) ||
      (required.includes('OPTI-SENSILIUM') && product.name.includes('Contour des Yeux')) ||
      (required.includes('VITA-SENSILIUM') && product.name.includes('Cr√®me L√©g√®re SPF20')) ||
      (required.includes('HYALURO-SENSILIUM') && product.name.includes('Cr√©me Hydratante Riche en Eau')) ||
      (required.includes('MEDI PROTECTRICE') && product.name.includes('Cr√®me Protectrice Sp√©cifique')) ||
      (required.includes('CORNEO-SENSILIUM') && product.name.includes('Cr√®me R√©paratrice et R√©g√©n√©ratrice')) ||
      (required.includes('Correction solaire 02 Ivoire') && product.name.includes('Fluide protecteur et correcteur la plus haute protection')) ||
      (required.includes('Correction solaire 01 Sable') && product.name.includes('Fluide protecteur-correctif haute protection'))
    )
    
    if (!isInRequiredList) {
      extraProducts.push(product.name)
      extraCount++
    }
  }
  
  console.log('\nüìä VERIFICATION SUMMARY:')
  console.log(`‚úÖ Found: ${foundCount} products`)
  console.log(`‚ùå Missing: ${missingCount} products`)
  console.log(`‚ûï Extra: ${extraCount} products`)
  
  if (missingProducts.length > 0) {
    console.log('\n‚ùå Missing products:')
    missingProducts.forEach(product => {
      console.log(`  - ${product}`)
    })
  }
  
  if (extraProducts.length > 0) {
    console.log('\n‚ûï Extra products:')
    extraProducts.forEach(product => {
      console.log(`  - ${product}`)
    })
  }
  
  // Display current products by category
  console.log('\nüìÇ Current products by category:')
  const categories = ['GAMME W - Anti-Taches', 'GAMME V - Vitiligo', 'GAMME T - Acn√©ique', 'GAMME S - Protection solaire', 'GAMME P - Psoriasis', 'GAMME H - Cheveux et Cuir chevelu', 'GAMME E - Peau S√®che et Atopique', 'GAMME A - Peau Allergique et Sensible', 'GAMME F - Fluid Fondation']
  
  for (const categoryName of categories) {
    const categoryProducts = currentProducts.filter(p => p.category?.name === categoryName)
    console.log(`\n${categoryName}:`)
    if (categoryProducts.length === 0) {
      console.log('  (No products)')
    } else {
      categoryProducts.forEach(product => {
        console.log(`  - ${product.name}`)
      })
    }
  }
  
  await prisma.$disconnect()
}

verifyPharmacerisProducts().catch(console.error)
